
const i18n = {
  lang: localStorage.getItem('lang') || 'es',
  t: {
    es: {nav_services:'Servicios', nav_prices:'Precios', nav_request:'Solicitud', nav_contact:'Contacto', nav_gallery:'Galer√≠a', btn_contact:'Cont√°ctanos',
      hero_title:'Viaja y gestiona tus tr√°mites con <span style="color: var(--blue)">Luna Travel</span>', hero_sub:'Asesor√≠a confiable para tr√°mites consulares cubanos, venta de pasajes a todo el mundo, env√≠o de paqueter√≠a, renta de autos, traducciones y notarizaciones.', hero_cta_fill:'Llenar solicitud', hero_cta_prices:'Ver precios', hero_note:'üí¨ Chat en vivo activo (Crisp) abajo a la derecha.', hero_card_title:'Chat en vivo', hero_card_body:'<p>Chatea con nosotros en tiempo real. Si escribes fuera de horario, te respondemos por correo.</p><ul><li>Burbujita de chat siempre visible</li><li>Mensajes autom√°ticos de bienvenida</li><li>Captura de nombre y correo</li></ul>',
      services_title:'Servicios', prices_title:'Precios', prices_note:'*Precios referenciales. Editables desde el panel /admin.',
      form_title:'Solicitud de Servicio (Asesor√≠a)', form_service:'Servicio', form_date_req:'Fecha de solicitud', form_passport:'N√∫mero de pasaporte', form_id:'Carn√© de identidad', form_lastname1:'Primer apellido *', form_lastname2:'Segundo apellido', form_name1:'Primer nombre *', form_name2:'Segundo nombre', form_gender:'Sexo', form_height:'Estatura (cm)', form_eyes:'Color de ojos', form_skin:'Color de piel', form_hair:'Color de cabello', form_birthdate:'Fecha de nacimiento', form_birthcountry:'Pa√≠s de nacimiento', form_birthprov:'Provincia', form_birthcity:'Municipio / Ciudad', form_address:'Direcci√≥n (calle, nr., apto, entre calles)', form_zip:'C√≥digo postal', form_state:'Provincia / Estado / Regi√≥n', form_country:'Pa√≠s', form_phone:'Tel√©fono', form_email:'E-mail *', form_work:'Centro de trabajo / estudio', form_job:'Ocupaci√≥n / Profesi√≥n', form_exit:'Fecha de salida de Cuba', form_obs:'Observaciones', form_legal:'Al enviar, autorizas a Luna Travel a contactarte para continuar el tr√°mite.', form_submit:'Enviar solicitud',
      contact_title:'Contacto', contact_text:'¬øTienes dudas? Escr√≠benos y te contactaremos.', contact_phone_label:'Tel√©fono', contact_address_label:'Direcci√≥n', contact_hours:'Horarios', hours_monfri:'Lunes a Viernes: 09:00am a 06:00pm', hours_sat:'S√°bado: 08:00am a 05:00pm', hours_sun:'Domingo: 09:00am a 02:00pm',
      gallery_title:'Galer√≠a', testimonials_title:'Lo que dicen nuestros clientes'},
    en: {nav_services:'Services', nav_prices:'Prices', nav_request:'Request', nav_contact:'Contact', nav_gallery:'Gallery', btn_contact:'Contact us',
      hero_title:'Travel and manage your paperwork with <span style="color: var(--blue)">Luna Travel</span>', hero_sub:'Reliable assistance for consular procedures, flight tickets worldwide, packages, car rentals, translations and notarizations.', hero_cta_fill:'Fill request', hero_cta_prices:'See prices', hero_note:'üí¨ Live chat (Crisp) active at the bottom right.', hero_card_title:'Live chat', hero_card_body:'<p>Chat with us in real time. If you write outside business hours, we will reply by email.</p><ul><li>Chat bubble always visible</li><li>Welcome automations</li><li>Name and email capture</li></ul>',
      services_title:'Services', prices_title:'Prices', prices_note:'*Reference prices. Editable from /admin panel.',
      form_title:'Service Request (Advisory)', form_service:'Service', form_date_req:'Request date', form_passport:'Passport number', form_id:'National ID', form_lastname1:'First surname *', form_lastname2:'Second surname', form_name1:'First name *', form_name2:'Second name', form_gender:'Gender', form_height:'Height (cm)', form_eyes:'Eye color', form_skin:'Skin color', form_hair:'Hair color', form_birthdate:'Date of birth', form_birthcountry:'Country of birth', form_birthprov:'Province/State', form_birthcity:'City / Municipality', form_address:'Address', form_zip:'ZIP code', form_state:'State / Region', form_country:'Country', form_phone:'Phone', form_email:'E-mail *', form_work:'Work / Study center', form_job:'Occupation / Profession', form_exit:'Departure date from Cuba', form_obs:'Notes', form_legal:'By sending, you authorize Luna Travel to contact you to continue the process.', form_submit:'Send request',
      contact_title:'Contact', contact_text:'Questions? Write to us and we will contact you.', contact_phone_label:'Phone', contact_address_label:'Address', contact_hours:'Opening hours', hours_monfri:'Mon‚ÄìFri: 09:00am to 06:00pm', hours_sat:'Saturday: 08:00am to 05:00pm', hours_sun:'Sunday: 09:00am to 02:00pm',
      gallery_title:'Gallery', testimonials_title:'What our clients say'}
  }
};
function applyI18n(){ const dict = i18n.t[i18n.lang]; document.querySelectorAll('[data-i18n]').forEach(node=>{const key=node.getAttribute('data-i18n'); if(dict[key]) node.innerHTML=dict[key];}); const contactBtn=document.getElementById('contactBtn'); if(contactBtn) contactBtn.innerHTML = dict['btn_contact']||contactBtn.innerHTML; document.documentElement.lang=i18n.lang; }
document.addEventListener('DOMContentLoaded', ()=>{ const langBtn=document.getElementById('langToggle'); langBtn.addEventListener('click', ()=>{ i18n.lang=(i18n.lang==='es')?'en':'es'; localStorage.setItem('lang', i18n.lang); location.reload(); }); });
// fade-in
const io=new IntersectionObserver(es=>{es.forEach(e=>{if(e.isIntersecting){e.target.classList.add('visible'); io.unobserve(e.target);}})},{threshold:.15});
window.addEventListener('DOMContentLoaded', ()=>{ document.querySelectorAll('.fade').forEach(el=>io.observe(el)); applyI18n(); init(); });
async function loadJSON(path){ const r=await fetch(path+'?_='+Date.now()); return await r.json(); }
async function init(){
  const pricing=await loadJSON('/data/pricing.json'); const contact=await loadJSON('/data/contact.json'); const gallery=await loadJSON('/data/gallery.json'); const testimonials=await loadJSON('/data/testimonials.json');
  const servicesGrid=document.getElementById('servicesGrid'); const pricingGrid=document.getElementById('pricingGrid'); const servicioSelect=document.getElementById('servicioSelect'); const lang=i18n.lang;
  (pricing.servicios||[]).forEach(item=>{ const name=(lang==='es')?(item.name_es||item.name||''):(item.name_en||item.name||''); const desc=(lang==='es')?(item.desc_es||item.desc||''):(item.desc_en||item.desc||''); const price=item.price||'';
    const card1=document.createElement('div'); card1.className='card'; card1.innerHTML='<div class="card-header"><h3>'+name+'</h3></div><div class="card-body">'+(desc||'')+'</div>'; servicesGrid.appendChild(card1);
    const card2=document.createElement('div'); card2.className='card'; card2.innerHTML='<div class="card-header"><h3>'+name+'</h3></div><div class="card-body"><div class="price">'+price+'</div><p>'+(desc||'')+'</p></div>'; pricingGrid.appendChild(card2);
    const opt=document.createElement('option'); opt.textContent=name; servicioSelect.appendChild(opt);
  });
  const emailLink=document.getElementById('contactEmail'); const contactBtn=document.getElementById('contactBtn'); if(contact?.email){ emailLink.textContent=contact.email; emailLink.href='mailto:'+contact.email; if(contactBtn) contactBtn.href='mailto:'+contact.email+'?subject=Consulta%20Luna%20Travel'; }
  const phoneLink=document.getElementById('contactPhone'); if(contact?.phone){ phoneLink.textContent=contact.phone; phoneLink.href='tel:'+contact.phone.replace(/[^0-9+]/g,''); }
  const whatsLink=document.getElementById('contactWhats'); if(contact?.whatsapp){ whatsLink.textContent=contact.whatsapp; whatsLink.href='https://wa.me/'+contact.whatsapp.replace(/[^0-9]/g,''); }
  const addr=document.getElementById('contactAddress'); if(contact?.address){ addr.textContent=contact.address; }
  const galleryGrid=document.getElementById('galleryGrid'); (gallery.images||[]).forEach(img=>{ const wrap=document.createElement('div'); wrap.className='card'; wrap.innerHTML='<div class="card-body"><img src="'+img.image+'" alt="Galer√≠a" style="width:100%;border-radius:12px"/></div>'; galleryGrid.appendChild(wrap); });
  const testiGrid=document.getElementById('testimonialsGrid'); (testimonials.items||[]).forEach(t=>{ const wrap=document.createElement('div'); wrap.className='card'; wrap.innerHTML='<div class="card-header"><h3>'+ (t.first_name||'') +'</h3></div><div class="card-body"><p>'+ (t.comment||'') +'</p></div>'; testiGrid.appendChild(wrap); });
  const form=document.getElementById('requestForm'); form.addEventListener('submit', (e)=>{ e.preventDefault(); const data=Object.fromEntries(new FormData(form).entries()); const subject=encodeURIComponent('Nueva solicitud - Luna Travel'); const body=encodeURIComponent(JSON.stringify(data, null, 2)); const to=(contact&&contact.email)?contact.email:'lunatravel25@yahoo.com'; window.location.href=`mailto:${to}?subject=${subject}&body=${body}`; });
}
