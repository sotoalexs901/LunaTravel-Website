<section id="contacto" style="max-width:700px;margin:40px auto;padding:24px;border:1px solid #eee;border-radius:16px;">
  <h2 style="margin-top:0;">Contáctanos</h2>
  <p>Completa el formulario y te responderemos pronto.</p>

  <!-- FORMULARIO NETLIFY -->
  <form id="contact-form"
        name="contact"
        method="POST"
        data-netlify="true"
        netlify-honeypot="bot-field"
        style="display:grid;gap:12px;">

    <!-- Requerido por Netlify -->
    <input type="hidden" name="form-name" value="contact">

    <!-- Honeypot (oculto para humanos, visible para bots) -->
    <div style="display:none;">
      <label>Si eres humano, deja esto vacío:
        <input name="bot-field">
      </label>
    </div>

    <label>
      Nombre
      <input type="text" name="name" required placeholder="Tu nombre" />
    </label>

    <label>
      Email
      <input type="email" name="email" required placeholder="tucorreo@ejemplo.com" />
    </label>

    <label>
      Teléfono (opcional)
      <input type="tel" name="phone" placeholder="+1 (___) ___-____" />
    </label>

    <label>
      Mensaje
      <textarea name="message" rows="5" required placeholder="Cuéntanos qué necesitas…"></textarea>
    </label>

    <!-- reCAPTCHA opcional de Netlify: descomenta si lo quieres
    <div data-netlify-recaptcha="true"></div>
    -->

    <button id="submit-btn" type="submit" style="padding:12px 18px;border-radius:10px;border:none;cursor:pointer;">
      Enviar
    </button>

    <!-- Estado / Mensajes -->
    <p id="form-status" style="margin:0.5rem 0 0;display:none;"></p>
  </form>

  <!-- JS: envío sin recargar + feedback -->
  <script>
    (function () {
      const form = document.getElementById('contact-form');
      const btn  = document.getElementById('submit-btn');
      const msg  = document.getElementById('form-status');

      function encode(data) {
        return Object.keys(data)
          .map(key => encodeURIComponent(key) + '=' + encodeURIComponent(data[key]))
          .join('&');
      }

      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        msg.style.display = 'block';
        msg.textContent = 'Enviando…';
        btn.disabled = true;

        // Construir payload como application/x-www-form-urlencoded (lo que espera Netlify)
        const formData = new FormData(form);
        const payload = { 'form-name': form.getAttribute('name') };
        for (const [k, v] of formData.entries()) payload[k] = v;

        try {
          const res = await fetch('/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: encode(payload)
          });

          if (res.ok) {
            form.reset();
            msg.textContent = '¡Gracias! Tu mensaje fue enviado correctamente.';
          } else {
            msg.textContent = 'Ocurrió un problema al enviar. Intenta de nuevo en unos segundos.';
          }
        } catch (err) {
          msg.textContent = 'No se pudo conectar. Revisa tu conexión e intenta otra vez.';
        } finally {
          btn.disabled = false;
        }
      });
    })();
  </script>
</section>

